\documentclass[xelatex,ja=standard,a4paper,14pt,everyparhook=compat]{bxjsarticle}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools, bm}
\usepackage{enumitem}
\usepackage{hyperref}
\setenumerate{label=(\alph*)}

% \usepackage{concmath}
% \usepackage[OT1]{fontenc}
\setsansfont{Segoe UI}
% \setmainfont{CMU Concrete}
% \usepackage{zxjatype}
\usepackage[noto-jp,oneweight]{zxjafont}
% \setCJKmainfont{Noto Serif JP}
% \setCJKsansfont{Noto Sans JP}

\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{\nouppercase{\leftmark}}
\rhead{\nouppercase{\rightmark}}
\renewcommand{\footrulewidth}{0.4pt}
\let\origtitle\title
\renewcommand{\title}[1]{\lfoot{#1}\origtitle{#1}}
\cfoot{}
\rfoot{\thepage}

\newcommand{\defby}{\overset{\mathrm{def}}{\iff}}

\newcommand{\bbC}{\mathbb{C}}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbQ}{\mathbb{Q}}
\newcommand{\bbZ}{\mathbb{Z}}
\newcommand{\bbN}{\mathbb{N}}
\newcommand{\bbP}{\mathbb{P}}
\newcommand{\bbF}{\mathbb{F}}
\newcommand{\frakS}{\mathfrak{S}}
\newcommand{\mcA}{\mathcal{A}}
\newcommand{\mcB}{\mathcal{B}}
\newcommand{\mcS}{\mathcal{S}}
\newcommand{\umod}{{\bmod\:}}
\DeclareMathOperator{\inv}{inv}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\image}{Im}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\nullity}{null}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\codim}{codim}

\theoremstyle{definition}
% \newtheorem{theorem}{定理}
\newtheorem*{theorem}{定理}
% \newtheorem{lemma}{補題}
\newtheorem*{lemma}{補題}
% \newtheorem{example}[theorem]{例}
\newtheorem*{example}{例}
% \newtheorem{definition}[theorem]{定義}
\newtheorem*{definition}{定義}
% \newtheorem{proposition}[theorem]{命題}
\newtheorem*{proposition}{命題}
% \newtheorem{corollary}[theorem]{系}
\newtheorem*{corollary}{系}
\newtheorem{problem}{問題}
\newtheorem*{answer}{解答}
\renewcommand{\proofname}{\textup{証明}}

\usepackage{tcolorbox}
\tcbuselibrary{breakable,skins,theorems}

\tcolorboxenvironment{definition}{
    coltitle = black,
    % colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{definition*}{
    coltitle = black,
    % colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{theorem}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{theorem*}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{proposition}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{proposition*}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{corollary}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{corollary*}{
    coltitle = black,
    % colback = black!10!white,
    colframe = blue!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{lemma}{
    coltitle = black,
    % colback = black!10!white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{example}{
    coltitle = black,
    colback = white,
    colframe = purple!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{example*}{
    coltitle = black,
    colback = white,
    colframe = purple!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{lemma*}{
    coltitle = black,
    % colback = black!10!white,
    colframe = gray!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{proof}{
    blanker,
    breakable,
    left=5mm,
    before skip=10pt,
    after skip=10pt,
    borderline west={1mm}{0pt}{black}
}

\tcolorboxenvironment{proof*}{
    blanker,
    breakable,
    left=5mm,
    before skip=10pt,
    after skip=10pt,
    borderline west={1mm}{0pt}{black}
}

\tcolorboxenvironment{problem}{
    coltitle = black,
    % colback = black!10!white,
    colframe = black!35!black,
    fonttitle = \bfseries,
    breakable = true
}

\tcolorboxenvironment{answer}{
    blanker,
    breakable,
    left=5mm,
    before skip=10pt,
    after skip=10pt,
    borderline west={1mm}{0pt}{black}
}

\title{3.11節の残り}
\author{shino16}
\date{\today}

\begin{document}

\maketitle

\tableofcontents

\newpage

\setcounter{section}{-1}
\section{復習}

\begin{definition}
    配置$\mcA$について， \begin{equation*}
        \text{Intersection poset $L(\mcA) \coloneqq \{\text{$0$個以上の超平面の非空な交わり}\}$}.
    \end{equation*}
    $\hat 0f = V$．$s \leq t \overset{\mathrm{def}}{\iff} s \supseteq t$．
\end{definition}

\begin{definition}
    \begin{align*}
        \text{特性多項式 $\chi_\mcA(x)$ }
         & \coloneqq \sum_{t \in L(\mcA)} \mu(\hat0, t) x^{\dim(t)} \\
         & = \sum_{\substack{\mcB \subseteq \mcA                    \\ \text{central}}} (-1)^{\#\mcB} x^{n - \rank(\mcB)} && (\text{命題3.11.3}).
    \end{align*}
\end{definition}

\begin{proposition}[3.11.5, Deletion-Restriction]
    配置$\mcA$，$H_0 \in \mcA$について \begin{align*}
        \mcA'  & \coloneqq \mcA - \{H_0\},                                          \\
        \mcA'' & \coloneqq \mcA^{H_0} = \{H \cap H_0 \neq \emptyset : H \in \mcA\}.
    \end{align*}
    このとき \begin{equation*}
        \chi_A(x) = \chi_{\mcA'}(x) - \chi_{\mcA''}(x).
    \end{equation*}
\end{proposition}

\begin{definition}
    $V : \text{実線形空間}$について \begin{align*}
        r(\mcA) & \coloneqq \#(\text{領域}) = r(\mcA') + r(\mcA''),                             \\
        b(\mcA) & \coloneqq \#(\text{相対的に有界な領域}) \quad (\text{essentializeすると有界}) \\
                & = \begin{cases}
            b(\mcA') + b(\mcA'') & \text{if $\rank(\mcA) = \rank(\mcA')$,}     \\
            0                    & \text{if $\rank(\mcA) = \rank(\mcA') + 1$.}
        \end{cases}
    \end{align*}
\end{definition}

\begin{theorem}
    \begin{align*}
        r(\mcA) & = (-1)^n \chi_\mcA(-1),            \\
        b(\mcA) & = (-1)^{\rank(\mcA)} \chi_\mcA(1).
    \end{align*}
\end{theorem}

\section{General Positionと特性多項式}

\begin{definition}
    $\mcA$の超平面はgeneral positionにある

    $\overset{\mathrm{def}}{\iff}$ 以下が同時に成立： \begin{enumerate}
        \item $\{H_1,\ldots,H_p\} \subseteq \mcA$, $p \leq n$ $\Longrightarrow$ $\dim(H_1 \cap \cdots \cap H_p) = n-p$,
        \item $\{H_1,\ldots,H_p\} \subseteq \mcA$, $p > n$ $\Longrightarrow$ $H_1 \cap \cdots \cap H_p = \emptyset$.
    \end{enumerate}
\end{definition}

\begin{proposition}
    $\mcA:\text{general position}$，$m = \#\mcA$について \begin{align*}
        \chi_\mcA(x) & = \sum_{k=0}^n (-1)^k \binom{m}{k} x^{n-k}                            \\
                     & = x^n - mx^{n-1} + \binom{m}{2}x^{n-2} - \cdots + (-1)^n\binom{m}{n}.
    \end{align*}
\end{proposition}
\begin{proof}
    方針：$L(\mcA)$の構造に注目．$\mu(\hat0,t)$をexplicitに求める．

    \begin{align*}
        \mcA & = \{H_1,\ldots,H_m\},                                           \\
        P    & = \{S \subseteq [m] : \#S \leq n\}\text{ を包含関係で順序付け}, \\
        \phi & : P \to L(\mcA), \quad S \mapsto \bigcap_{i \in S} H_i,
    \end{align*}
    とする\footnote{$P$はtruncated boolean algebraと呼ばれる．}．このとき \begin{enumerate}
        \item $\phi$は全射：明らか．
        \item $\phi$は単射： \begin{align*}
                                    & \phi(S) = \phi(S')                          \\
                  \Longrightarrow{} & \phi(S) = \phi(S \cup S')                   \\
                  \Longrightarrow{} & n - \#S = \dim(\phi(S)) = n - \#(S \cup S') \\
                  \Longrightarrow{} & S = S'.
              \end{align*}
        \item $\phi$と$\phi^{-1}$は順序を保つ： \begin{equation*}
                  S \subseteq S' \iff \phi(S) \supseteq \phi(S').
              \end{equation*}
    \end{enumerate}
    ゆえに$L(\mcA) \cong P$．

    $[\hat0,S] \cong B_{\#S}$より$\mu(\hat0,S) = (-1)^{\#S}$，また$\dim(\phi(S)) = n - \#S$より \begin{align*}
        \chi_\mcA(x) & = \sum_{t \in L(\mcA)} \mu(\hat0,t) x^{\dim(t)} \\
                     & = \sum_{S \in P} (-1)^{\#S} x^{n-\#S}           \\
                     & = \sum_{k=0}^n (-1)^k \binom{m}{k} x^{n-k}.
    \end{align*}
\end{proof}

なお$V:\text{実線形空間}$について \begin{align*}
    r(\mcA) = (-1)^n \chi_\mcA(-1)
     & = \sum_{k=0}^n \binom{m}{k}                     \\
     & = 1 + m + \binom{m}{2} + \cdots + \binom{m}{n}.
\end{align*}
$m < n$のとき \begin{align*}
    b(\mcA) & = (-1)^m \chi_\mcA(1)                     \\
            & = (-1)^m \sum_{k=0}^m (-1)^k \binom{m}{k} \\
            & = \delta_{0m},
\end{align*}
$m \geq n$のとき$\rank(\mcA) = n$より \begin{align*}
    b(\mcA) & = (-1)^n \chi_\mcA(1)                  \\
            & = \sum_{k=0}^n (-1)^{n-k} \binom{m}{k} \\
    % & = (-1)^n \left[ 1 - m + \binom{m}{2} - \cdots + (-1)^n \binom{m}{n} \right] \\
            & = \binom{m-1}{n}.
\end{align*}
(注)最後の等号について： \begin{enumerate}
    \item 漸化式を用いる： \begin{align*}
                  & \binom{m}{n} - \binom{m}{n-1} + \binom{m}{n-2} - \cdots                                                \\
              ={} & \left[\binom{m-1}{n}+\binom{m-1}{n-1}\right] - \left[\binom{m-1}{n-1}+\binom{m-1}{n-2}\right] + \cdots \\
              ={} & \binom{m-1}{n}.
          \end{align*}
    \item FPS： \begin{equation*}
              (-1)^n [x^n] \frac{1}{1-x}(1-x)^m = \binom{m-1}{n}.
          \end{equation*}
\end{enumerate}

\newpage

\section{有限体法}

$\bbQ$上の配置$\mcA$の特性多項式を，有限体を使って計算しよう．

\subsection{$\bbQ$から$\bbF_q$への帰着}

\begin{itemize}
    \item $\mcA$全体を同時に整数倍して分母をはらう．
    \item 素ベキ$q$をとって全体の$\umod q$をとり，$\mcA_q$を得る．
\end{itemize}

\begin{definition}
    $\mcA$は$\umod q$で\textbf{良い帰着}を持つ $\overset{\mathrm{def}}{\iff}$ $L(\mcA) \cong L(\mcA_q)$．
\end{definition}

\begin{proposition}
    $\bbZ$上の配置$\mcA$について，$\mcA$が$\umod p$で良い帰着を持たないような素数$p$は有限個のみ．
\end{proposition}
\begin{proof}
    $H_1,\ldots,H_j \in \mcA$ ($H_i : \alpha_i \cdot x = a_i$)について， \begin{align} \label{rank}
               & H_1 \cap \cdots \cap H_j \neq \emptyset \nonumber                   \\
        \iff{} & \rank\begin{pmatrix}
            \alpha_1 & a_1    \\
            \vdots   & \vdots \\
            \alpha_j & a_j
        \end{pmatrix} = \rank \begin{pmatrix}
            \alpha_1 \\
            \vdots   \\
            \alpha_j
        \end{pmatrix}.
    \end{align}
    また$H_1 \cap \cdots \cap H_j \neq \emptyset$ならば \begin{equation} \label{dim}
        \dim(H_1 \cap \cdots \cap H_j) = \nullity \begin{pmatrix}
            \alpha_1 \\
            \vdots   \\
            \alpha_j
        \end{pmatrix} = n - \rank \begin{pmatrix}
            \alpha_1 \\
            \vdots   \\
            \alpha_j
        \end{pmatrix}.
    \end{equation}
    等式(\ref{rank})の成立/不成立と式(\ref{dim})の値が$\bbZ$上，$\bbF_q$上で一致すればよい．

    ($\because$ 増えない(1)，潰れない(2)，大小関係を保つ(明らか)，比較不可能な関係を保つ(2))

    $(\text{行列の$\rank$}) = (\text{$\max k$ s.t. 正則な$k \times k$小行列が存在})$より，どの正方小行列についても行列式が非ゼロから$\umod p$でゼロにならなければよい．$p$を十分大きくとればOK．
\end{proof}

\subsection{$\chi_\mcA(q)$の計算}

この節のメイン．

\begin{theorem}[3.11.10]
    $\bbQ^n$上の配置$\mcA$，$L(\mcA) \cong L(\mcA_q)$なる素ベキ$q$について， \begin{align*}
        \chi_\mcA(q) & = \#\left(\bbF_q^n - \bigcup_{H \in \mcA_q} H\right) \\
                     & = q^n - \#\bigcup_{H \in \mcA_q} H.
    \end{align*}
\end{theorem}
無限個の$q$について上の等式が成り立つので，補完で$\chi_\mcA(x)$が得られる．
\begin{proof}
    方針：$\chi_\mcA(q)$をM\"obius反転の式にあてはめる．

    $f,g : L(\mcA_q) \to \bbZ$を \begin{align*}
        f(t) & = \#t = q^{\dim(t)},                    \\
        g(t) & = \#\left(t - \bigcup_{u > t} u\right),
    \end{align*}
    で定める．$f(t) = \sum_{u \geq t} g(u)$より \begin{align*}
        g(t) & = \sum_{u \geq t} \mu(t,u) f(u)         \\
             & = \sum_{u \geq t} \mu(t,u) q^{\dim(u)}.
    \end{align*}
    $t = \hat0$を代入して \begin{equation*}
        g(\hat0) = \chi_\mcA(q) = \#\left(\bbF_q^n - \bigcup_{H \in \mcA_q} H\right).
    \end{equation*}
\end{proof}

\subsection{例：ブレイド配置}
braid……組みひも

\begin{definition}
    ランク$n-1$の\textbf{ブレイド配置} \begin{align*}
        \mcB_n = \{x_i - x_j = 0 : 1 \leq i < j \leq n\} \text{ in $K^n$}.
    \end{align*}
    これは直線$x_1=\cdots=x_n$を含む$\binom{n}{2}$個の超平面の集まり．
\end{definition}
例：$\mcB_3$ \url{https://www.geogebra.org/3d/uxubgxrc}

特性多項式を有限体法で計算しよう．十分大きな素数$p$について，定理3.11.10より \begin{align*}
    \chi_{\mcB_n}(p) & = \#\{(x_1,\ldots,x_n) \in \bbF_p^n : \text{$x_i \neq x_j$ ($\forall i < j$)}\} \\
                     & = (p)_n.
\end{align*}
ゆえに \begin{equation*}
    \chi_{\mcB_n}(x) = (x)_n.
\end{equation*}
実は$L(\mcB_n) \cong \Pi_n$ (なぜ？)．

\subsection{例：Shi配置}

\begin{definition}
    \begin{equation*}
        \text{\textbf{Shi配置} $\mcS = \{x_i, x_j = c : \text{$c \in \{0, 1\}$, $i \leq i < j \leq n$}\}$.}
    \end{equation*}
\end{definition}

\begin{theorem}[3.11.7]
    \begin{equation*}
        \chi_{\mcS_n}(x) = x(x-n)^{n-1}.
    \end{equation*}
\end{theorem}
\begin{proof}
    素数$p$について次を示す： \begin{equation*}
        \#\left(\bbF_p^n - \bigcup_{H \in (\mcS_n)_p} H\right) = p(p-n)^{n-1}.
    \end{equation*}

    次の条件を満たす$\pi=(B_1,\ldots,B_{p-n})$を考える\footnote{$[n]$のweak ordered partition}： \begin{enumerate}
        \item $\bigcup B_i = [n]$,
        \item $B_i \cup B_j = \emptyset$ ($i \neq j$), and
        \item $1 \in B_1$.
    \end{enumerate}
    $(a, \pi)$ ($a \in \bbF_p$)を$\bbF_p^n-\bigcup_{H \in (\mcS_n)_p} H$の元に一対一に対応させよう．

    \begin{itemize}
        \item for $i$ in $1,\ldots,p-n$: \begin{itemize}
                  \item for $j$ in $B_i$ (昇順): \begin{itemize}
                            \item $\alpha_j \gets a$.
                            \item $a \gets a + 1$.
                        \end{itemize}
                  \item $a \gets a + 1$.
              \end{itemize}
              % \item assert $a = (\text{$a$の初期値})$.
    \end{itemize}
    例：$p = 11$, $n = 6$, $a = 6$, $\pi = (\{1,4\}, \{5\}, \emptyset, \{2,3,6\}, \emptyset)$: \begin{equation*}
        \text{$\alpha_1 = 6$, $\alpha_4 = 7$, $\alpha_5 = 9$, $\alpha_2 = 1$, $\alpha_3 = 2$, $\alpha_6 = 3$.}
    \end{equation*}

    $(\alpha_1,\ldots,\alpha_n) \in \left(\bbF_p^n - \bigcup_{H \in (\mcS_n)_p} H\right)$： \begin{equation*}
        \text{$\alpha_i - \alpha_j = 1$ $\implies$ $i,j$は$\pi$上で同一ブロックに属し，$j < i$．}
    \end{equation*}

    全単射性：$\alpha_1,\ldots,\alpha_n$を，$\alpha_1$を先頭として昇順に並べる(informal)．

    $\alpha_1$から$a$が，$p-n$個のギャップから$p-n$個のブロックとそれらの間の順番が一意に決まる．

    各$1 < i \leq n$について，$i$が所属するブロックが$p-n$通りあることから，$(a,\pi)$は$p (p-n)^{n-1}$通り．
\end{proof}

\begin{corollary}[3.11.14]
    \begin{align*}
        r(\mcS_n) & = (n+1)^{n-1}, \\
        b(\mcS_n) & = (n-1)^{n-1}.
    \end{align*}
\end{corollary}

$r(\mcS_2) = 3$, $b(\mcS_2) = 1$.

$r(\mcS_3) = 4^2 = 16$, $b(\mcS_3) 2^2 = 4$.

\newpage

\section{問題}

\setcounter{problem}{107}
\begin{problem}
    単純グラフ$G = (V,E)$について，$G$の\textbf{$n$-彩色}とは次を満たす$f: V \to [n]$： \begin{itemize}
        \item $f(a) \neq f(b)$ ($\{a,b\} \in E$).
    \end{itemize}
    $\chi_G: n \mapsto \#(\text{$G$の$n$-彩色})$は$G$の\textbf{彩色多項式}．$p \coloneqq \#V$．

    \begin{enumerate}[label=\alph*.]
        \item $V$の\textbf{安定な分割}：全てのブロックが$G$の安定集合．

        $S_G(j) \coloneqq \#(\text{$V$の安定な$j$ブロック分割})$について次を示せ： \begin{equation*}
            \chi_G(n) = \sum_{j=1}^n S_G(j) (n)_j.
        \end{equation*}
        \item 半順序集合$L_G \coloneqq \{\pi : \text{$V$の分割，各ブロックが$G$で連結}\}$．

        次を示せ： \begin{equation*}
            \chi_G(n) = \sum_{\pi \in L_G} \mu(\hat0, \pi) n^{\#\pi}.
        \end{equation*}

        なお，これより$\chi_G(n) = n^{\#(\text{$G$の連結成分})} \chi_{L_G}(n)$．
    \end{enumerate}
\end{problem}
\begin{answer}[a.]
    ちょうど$j$色を使う$n$-彩色は$S_G(j) (n)_j$通り．ただし$(n)_j$は$j$個のブロックに色を割り当てる方法の数．
    % これより$\chi_G(n)$は$n$の$p$次多項式であり，$[n^p]\chi_G(n) = 1$，$[n^{p-1}]\chi_G(n) = -(\#E)$.
\end{answer}

\end{document}
